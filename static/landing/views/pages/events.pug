extends ./../index.pug

block main-content
  h1
    | Фестивали

  div.events-page-wrapper
    if yearList.length
      ul.year-list
        each year in yearList
          li(class=year == eventsYear ? 'selected': '')
            a(href='/events/' + year)= year

    if eventsData.length
      each eventData, index in eventsData
        - var hasPassed = new Date > new Date(eventData.event.date)
        div.event-header
          h2= eventData.event.title
          div.event-header-bottom-container
            b.date= eventData.event.dateString
            if logedInUserData && (!hasPassed || eventData.request)
              - var linkText = eventData.request ? 'Открыть вашу заявку' : 'Подать заявку'
              - var linkSrc = eventData.request ? '/event_request/' + eventData.request.uid : '/events/' + eventData.event.uid + '/request/new'
              a.request-link(href=linkSrc)= linkText

        div.event-html-wrapper!= eventData.event.html

block after-index-script
  script(src='/dist/js/landing-events.js')